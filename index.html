<!-- meme generator multiplayer game
3 players (for now) -use auth if we get far enough
first page will show 4 buttons w/ 'player #'
once first user selects player, a timer will start to countdown for 60 seconds.
if countdown is complete and only 2 players have joined, game will not start. (else = start game)
selected players will be stored in firebase as a value. 

second page will show prompt with all attending players and ask if they are ready
click on ready and wait to begin
once all players are ready, begin a 3 sec countdown

next page will be first question
display random meme. use found meme api
60 second countdown to submit answer
after 60 seconds, take no submits
use timestamp to determine the first and second players that submitted
answers get appended to page. last two get removed
players will then vote for the funniest caption for the meme.

if there is a draw on voting, person who submitted answer first, gets 1 point




RULES:
1. 3 player min.
2. each round shows a meme on the screen, all players caption and submit
3. first two submitted will be the ones voted for. all others are removed
4. two submitted will be displayed for other players to vote for.
5. highest voted submit wins. score +2
6. if tie, user who submitted first score+1
7. first to 10.

api key:
ed0e5625-ed2d-4049-a830-bafce8b69716
sample api link
"http://version1.api.memegenerator.net//Generators_Search?q=drunk&pageIndex=0&pageSize=25&apiKey=ed0e5625-ed2d-4049-a830-bafce8b69716" -->
<!-- "http://version1.api.memegenerator.net//Generators_Select_ByNew?pageIndex=0&pageSize=25&apiKey=ed0e5625-ed2d-4049-a830-bafce8b69716" -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>meme generator</title>
    <style>
        .image, img{
            height: 80%;
            width: 80%;
            text-align: center;
            margin: auto;
        }
        body{
            margin: auto;
            text-align: center;
        }
        * {
            font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
            text-transform: lowercase;

        }
        .displayImage {
            margin: auto;
            height: 50%;
            width: 50%;
            /* background-color: aquamarine; */
            text-align: center;
        }
    </style>
</head>



<body>



<div class="buttonContainer"></div>
<div class="timer"></div>
<div class="inputContainer">
        <div class="displayImage">

        </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
// these arrays will be used to plug into the queryURL to add more range and randomness to the meme search
// var searchType = ['Generators_Search', 'Generators_Select_ByNew', 'Generators_Select_ByPopular', 'Generators_Select_ByTrending'];
var topic = ['funny', 'beer', 'jay-z', 'rap', 'dog', 'cat', 'girl', 'boy', 'poo', 'president', 'trump', 'sports', 'dance','drunk'];

var makeButton = $('<button>').text('meme').attr('id','start');
    $('.buttonContainer').append(makeButton);
var voteButton = $('<button>').text('vote').attr('id','vote');
    $('.buttonContainer').append(voteButton);
var rn = '';
var success = '';
var result = '';
var checker = '';
var docP = '';
var userInput = [];
var seconds = 61;
var timer;
// this empty array will hold all of the player's answers. 
var topTwoA = [];
var formDiv = $('<form>').addClass('formDiv');
var textField = $('<input>').attr('type','text').attr('placeholder','your caption').attr('id','text');
var submitButton = $('<input>').attr('type', 'submit').attr('value','submit').attr('id','submit');
    formDiv.append(textField).append(submitButton);
            $('.inputContainer').append(formDiv);

function createForm(){
        $('#text').val("");
        formDiv.append(textField).append(submitButton);
        $('.inputContainer').append(formDiv);
}



// TIMER FUNCTION
function setTimer(){
    seconds = seconds - 1;
    var makeTimer = $('<p>').text(`Time Remaining: ${seconds}`);
    $('.timer').html(makeTimer);

    if (seconds === -1){
        resetTimer();
    }
}


//MEME GENERATOR FUNCTION

function findMeme (){
    formDiv.append(textField).append(submitButton);
        $('.inputContainer').append(formDiv);
    //generate random number to pull a random object/image from the 25 memes pulled from the ajax response
    rn = Math.floor(Math.random()* 24) +1;
    
    //pull a random query method from searchType array to widen meme search. used .length in case we want to add more 
    // var rm = Math.floor(Math.random()* searchType.length);
    // var qm = searchType[rm];

    //pull a random search word from topic array to widen meme search. used .length in case we want to add more 
    var rw = Math.floor(Math.random()* topic.length);
    var sw = topic[rw];

    // added variables qm and sw to the queryURL 
    // var queryURL = `http://version1.api.memegenerator.net//${qm}?q=${sw}&pageIndex=${rn}&pageSize=25&apiKey=ed0e5625-ed2d-4049-a830-bafce8b69716`;
    var queryURL = `http://version1.api.memegenerator.net//Generators_Search?q=${sw}&pageSize=25&apiKey=ed0e5625-ed2d-4049-a830-bafce8b69716`;

    console.log(queryURL);
    // console.log(qm);
    console.log(sw);
    // added extra values to help our app work across different browsers and phones. (this worked for my last homework)
        $.ajax({
            url: queryURL,
            method: 'GET',
            cache: true,
        })

        .then(function(response){
            success = response.success;
            result = parseInt(response.result);
            // debugger;
                console.log(response);
            
            var imgDiv = $('<div>').addClass('image');
                docP = $('<p>').attr('id','userText').text('');
            //variable rn is used here at the image's source  
            var makeImg = $('<img>').attr('src', response.result[rn].imageUrl).attr('alt',response.result[rn].urlName);
                        
                imgDiv.append(makeImg);
                imgDiv.prepend(docP);
                $('.displayImage').html(imgDiv);
                    
                    if (result.length === 0){
                        console.log('empty')
                        return;
                    }
            });

}

//VOTING FUNCTION
function voteRound(){
        seconds = 61;
        clearInterval(timer);
        timer = setInterval(setTimer, 1000);
        docP.remove();
        userInput = [];
    for (c in topTwoA){   
        console.log(topTwoA[c]);
        var a = topTwoA[c];     
        var createChoices = $(`<input type="radio" name="a" value="${c}">`);
        var createLabel = $('<label>');
            createLabel.text(a);
            $('.inputContainer').append(createChoices);
            $('.inputContainer').append(createLabel); 
        //     correctAnswerArray.push(triviaQuestions[index].correctAnswer);
    }

}
  
//onclick that calls to findMeme function. we can change this later to a timed interval so it will pull the random photo for the next round.
$('.buttonContainer #start').on('click', function(){
    userInput = [];
    createForm();  
    seconds = 61;
    clearInterval(timer);
    findMeme();
    timer = setInterval(setTimer, 1000);
    docP.remove();
});
//onclick test for results function
$('.buttonContainer #vote').on('click', function(){
    voteRound();
})

//SUBMIT FUNCTION
$('form #submit').on('click', function(){
    event.preventDefault();
    var input = $('#text').val();
    
    if (topTwoA.length >= 2){
        return;
    }
    if (input == ''){
        return;
    } 
    else if (input != ""){
        var b = $('#userText');
        b.text(input);
        $('.inputContainer').prepend(b);
        userInput.push(input);
        topTwoA.push(input);
        $('#text').val("");
        console.log(input);
    }

})


</script>
</body>
</html>

<!-- notes: 'https://memegenerator.net/img/images/10519337.jpg' image is not found -->
